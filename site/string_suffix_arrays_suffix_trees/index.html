<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Brother Rain">
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Suffix Arrays and Suffix Trees - D&A</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../components/magiz-c-book/src/book.css" rel="stylesheet">
        <link href="../components/magiz-c-course/src/course.css" rel="stylesheet">
        <link href="../components/magiz-c-video/src/video.css" rel="stylesheet">
        <link href="../components/magiz-c-benchmark/src/benchmark.css" rel="stylesheet">
        <link href="../components/magiz-c-paper/src/paper.css" rel="stylesheet">
        <link href="../components/magiz-doc/style.css" rel="stylesheet">
        <link href="../components/magiz-doc/highlight.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-68978617-1', 'magizbox.com');
            ga('send', 'pageview');
        </script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../gs_introduction/">D&A</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Get Started <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../gs_introduction/">Introduction</a>
</li>
                            
<li >
    <a href="../gs_greedy_algorithms/">Greedy Algorithms</a>
</li>
                            
<li >
    <a href="../gs_divide_and_conquer/">Divide-and-Conquer</a>
</li>
                            
<li >
    <a href="../gs_dynamic_programming/">Dynamic Programming</a>
</li>
                            
<li >
    <a href="../7_steps/">7 Steps to Solve Algorithm Problems</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Data Structures <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../ds_array/">Arrays</a>
</li>
                            
<li >
    <a href="../ds_linked_list/">Linked List</a>
</li>
                            
<li >
    <a href="../ds_stack_queue/">Stacks & Queues</a>
</li>
                            
<li >
    <a href="../ds_hash_table/">Hash Tables</a>
</li>
                            
<li >
    <a href="../ds_tree/">Trees</a>
</li>
                            
<li >
    <a href="../ds_binary_search_tree/">Binary Search Trees</a>
</li>
                            
<li >
    <a href="../ds_heap/">Heaps</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Sort <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../sort_algorithms/">Sorting Algorithms</a>
</li>
                            
<li >
    <a href="../sort_bubble/">Bubble Sort</a>
</li>
                            
<li >
    <a href="../sort_insertion/">Insertion Sort</a>
</li>
                            
<li >
    <a href="../sort_selection/">Selection Sort</a>
</li>
                            
<li >
    <a href="../sort_merge/">Merge Sort</a>
</li>
                            
<li >
    <a href="../sort_shell/">Shell Sort</a>
</li>
                            
<li >
    <a href="../sort_quick/">Quick Sort</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="..">Search</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Graphs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../graph_data_structure/">Graph Data Structure</a>
</li>
                            
<li >
    <a href="../graph_dfs/">DFS: Depth First Traversal</a>
</li>
                            
<li >
    <a href="../graph_bfs/">BFS: Breadth First Traversal</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Strings <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../string_string/">Introduction to Strings</a>
</li>
                            
<li >
    <a href="../string_tries/">Tries</a>
</li>
                            
<li class="active">
    <a href="./">Suffix Arrays and Suffix Trees</a>
</li>
                            
<li >
    <a href="../string_kmp/">Knuth–Morris–Pratt Algorithm</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Advanced <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">NPs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="..">Complete coloring</a>
</li>
            
<li >
    <a href="..">Clique cover problem</a>
</li>
            
<li >
    <a href="..">Knapsack problem</a>
</li>
            
<li >
    <a href="..">Bin packing problem</a>
</li>
            
<li >
    <a href="..">Closest string</a>
</li>
            
<li >
    <a href="..">Longest common subsequence problem</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="..">Flows in Networks</a>
</li>
                            
<li >
    <a href="..">Linear Programming</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../string_tries/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../string_kmp/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#suffix-tree">Suffix tree</a></li>
        <li class="main "><a href="#suffix-array">Suffix Array</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="suffix-tree">Suffix tree</h1>
<p>A suffix tree <strong>T</strong> is a natural improvement over trie used in pattern matching problem, the one defined over a set of substrings of a string s. The idea is very simple here. Such a trie can have a long paths without branches. If we only can reduce these long paths into one jump, we will reduce the size of the trie significantly, so this is a great first step in improving the complexity of operations on such a tree. This reduced trie defined over a subset of suffixes of a string s is called a suffix tree of <strong>s</strong></p>
<p>For better understanding, let's consider the suffix tree T for a string <strong>s = abakan</strong>. A word abakan has 6 suffixes <strong>{abakan , bakan, akan, kan, an, n}</strong> and its suffix tree looks like this:</p>
<p><img alt="" src="https://he-s3.s3.amazonaws.com/media/uploads/fa2b26c.jpg" /></p>
<p>There is a <a href="https://en.wikipedia.org/wiki/Ukkonen%27s_algorithm">famous algorithm by Ukkonen</a> for building suffix tree for s in linear time in terms of the length of s. However, because it may look quite complicated at first sight, many people are discouraged to learn how it works. Fortunately, there is a great, I mean an excellent, <a href="../description of Ukkonen's algorithm given on StackOverflow">description of Ukkonen's algorithm given on StackOverflow</a>. Please refer to it for better understanding what a suffix tree is and how to build it in linear time.</p>
<p>Suffix trees can solve many complicated problems, because it contain so many information about the string itself. Fo example, in order to know how many times a pattern <strong>P</strong> occurs in <strong>s</strong>, it is sufficient to find <strong>P</strong> in <strong>T</strong> and return the size of a subtree corresponding to its node. Another well known application is finding the number of distinct substrings of s, and it can be solved easily with suffix tree, while the problem looks very complicated at first sight.</p>
<p>The post I linked from StackOverflow is so great, that you simple must read it. After that, you will be able to identify problems solvable with suffix trees easily.</p>
<p>If you want to know more about when to use a suffix tree, you should read this paper about the <a href="http://www.cs.elte.hu/~berkri/Theses/Vasarhelyi_2.pdf">applications of suffix trees</a>.</p>
<h1 id="suffix-array">Suffix Array</h1>
<p>Suffix array is a very nice array based structure. Basically, it is a lexicographically sorted array of suffixes of a string s. For example, let's consider a string <strong>s = abakan</strong>. A word abakan has 6 suffixes <strong>{abakan , bakan, akan, kan, an, n}</strong> and its suffix tree looks like this:</p>
<p><img alt="" src="https://he-s3.s3.amazonaws.com/media/uploads/029389f.jpg" /></p>
<p>Of course, in order to reduce space, we do not store the exact suffixes. It is sufficient to store their indices.</p>
<p>Suffix arrays, especially combined with <a href="https://en.wikipedia.org/wiki/LCP_array">LCP table</a> (which stands for Longest Common Prefix of neighboring suffixes table), are very very useful for solving many problems. I recommend reading this nice <a href="https://web.stanford.edu/class/cs97si/suffix-array.pdf">programming oriented paper about suffix arrays, their applications and related problems</a> by Stanford University.</p>
<p>Suffix arrays can be build easily in <script type="math/tex">O(n * log^2 n)</script> time, where n is the length of s, using the algorithm proposed in the paper from the previous paragraph. This time can be improved to <script type="math/tex">O(n * log n)</script> using linear time sorting algorithm.</p>
<p>However, there is so extraordinary, cool and simple linear time algorithm for building suffix arrays by Kärkkäinen and Sanders, that reading it is a pure pleasure and you cannot miss it.</p>
<p>Correspondence between suffix tree and suffix array</p>
<p>It is also worth to mention, that a suffix array can be constructed directly from a suffix tree in linear time using DFS traversal. Suffix tree can be also constructed from the suffix array and LCP table as described here.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script>
        <script src="../components/underscore/underscore.js"></script>
        <script src="../components/magiz-c-book/src/gspreadsheet.js"></script>
        <script src="../components/magiz-c-paper/src/paper.js"></script>
        <script src="../components/magiz-c-course/src/course.js"></script>
        <script src="../components/magiz-c-benchmark/src/benchmark.js"></script>
        <script src="../components/magiz-c-benchmark/src/bootstrap-popup.js"></script>
        <script src="../components/magiz-c-book/src/book.js"></script>
        <script src="../components/magiz-c-video/src/video.js"></script>
        <script src="../components/jquery/dist/jquery.js"></script>
        <script src="../components/magiz-doc/doc.js"></script>
        <script src="../components/magiz-doc/footer.js"></script>
        <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
